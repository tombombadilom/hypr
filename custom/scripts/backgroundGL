#!/bin/bash

# Chemin vers le script bgDaemon
BGDAEMON_PATH=~/.local/bin/glpaper/bgDaemon

# Fonction pour envoyer les commandes à bgDaemon
send_command_to_bgdaemon() {
  "$BGDAEMON_PATH" "$@"
}

# Vérifier les conditions et agir en conséquent
if ! pgrep glpaper > /dev/null; then
  # Aucun processus glpaper n'est actuellement en cours d'exécution,
  # donc on démarre un nouveau processus.
  if [[ -z "$1" ]]; then
    snd-notify 'Glpaper' 'Aucune sequence n''est en cours de lecture'
  else
    send_command_to_bgdaemon start
  fi
elif [[ -n "$1" ]]; then
  case "$1" in
    next)
      # Navigation vers le GLSL suivant
      send_command_to_bgdaemon next
      ;;
    prev)
      # Navigation vers le GLSL précédent
      send_command_to_bgdaemon prev
      ;;
    *)
      echo "Option invalide: $1"
      exit 1
      ;;
  esac
else
  # Un processus glpaper est en cours d'exécution et aucune navigation n'est demandée,
  # on arrête donc le processus et on termine backgroundGL.
  send_command_to_bgdaemon stop
  pkill -f backgroundGL
fi

exit 0

